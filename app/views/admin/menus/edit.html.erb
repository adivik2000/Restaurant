<h1><%= @menu.name %></h1>

<% form_for(@menu) do |f| %>
  <div class="field">
    <%= f.label :Name %><br />
    <%= f.text_field :name %><br />  
  </div>
  <div class="actions">
  <%= f.submit "Update menu name" %>
  </div>
<% end %>

<h3><%= @menu.name %> Dishes</h3>

<ul id="menu" class="move">
<% @menu.dishes.each do |dish| %> 
<li id="dish_<%= dish.id %>">
<%= dish.name %> - <%= dish.description %> - <%= dish.price %> - <%= link_to "edit", :controller => 'admin/dishes', :id => dish, :action => 'edit' %> - <%= link_to "delete", dish, :method => :delete, :confirm => "You sure?" %>
</li>
<% end %> </ul>

<h3>Add a dish</h3>
<% form_for(@dish) do |f| %>
  <div class="hidden_field"ยง>
    <%= f.hidden_field :menu_id, :value => params[:id] %><br />  
  </div>
  <div class="field">
    <%= f.label :name %><br />
    <%= f.text_field :name %><br />  
  </div>
  <div class="field">
    <%= f.label :description %><br />
    <%= f.text_field :description %><br />  
  </div>
  <div class="field">
    <%= f.label :price %><br />
    <%= f.text_field :price %><br />  
  </div><br />
  <div class="actions">
  <%= f.submit "Add new dish" %>
</div>
<% end %>

<%= link_to "delete menu", @menu, :method => :delete, :confirm => "You sure?" %>

<% content_for :jqueryui do %>
<% javascript_tag do %>
     $('#menu').sortable(
	    {
          axis: 'y', 
		   dropOnEmpty:false, 
	       cursor: 'crosshair',
	       items: 'li',
	       opacity: 0.4,
	       scroll: true,
          update: function(){
            $.ajax({
                type: 'post', 
                data: $('#menu').sortable('serialize') + '&id=<%= @menu.id-%>', 
                dataType: 'script', 
                complete: function(request){
                    $('#menu').effect('highlight');
                  },
                url: '/admin/menus/order_dishes'})
            }	
	
	})
<% end %>

<% end %>